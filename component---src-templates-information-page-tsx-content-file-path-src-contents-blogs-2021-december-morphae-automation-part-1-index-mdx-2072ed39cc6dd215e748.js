"use strict";(self.webpackChunksuttisak_personal_site=self.webpackChunksuttisak_personal_site||[]).push([[291],{4313:function(e,n,t){t.r(n),t.d(n,{default:function(){return E}});var l=t(8453),a=t(6540),i=t(7e3);function r(e){const n=Object.assign({h1:"h1",h2:"h2",ul:"ul",li:"li",a:"a",p:"p",strong:"strong",h3:"h3",pre:"pre",code:"code",ol:"ol"},(0,l.R)(),e.components);return a.createElement(a.Fragment,null,a.createElement(n.h1,{id:"สิ่งที่ต้องมี"},"สิ่งที่ต้องมี"),"\n",a.createElement(n.h2,{id:"เตรียม-project"},"เตรียม Project"),"\n",a.createElement(n.ul,null,"\n",a.createElement(n.li,null,"ติดตั้ง Windows App SDK และ Visual Studio 2022 ซึ่งสามารถทำตามได้ จาก ",a.createElement(n.a,{href:"https://docs.microsoft.com/en-us/windows/apps/windows-app-sdk/set-up-your-development-environment?tabs=vs-2022"},"Install tools for developing apps for Windows 10 and Windows 11")),"\n",a.createElement(n.li,null,"สร้าง Blank Win UI 3.0 Desktop จาก Visual Studio 2022 (ไม่แนะนำ UWP เพราะไม่รองรับ .Net 6)"),"\n",a.createElement(n.li,null,"เพิ่ม Selenium.WebDriver 4.1+ package จาก Nuget"),"\n",a.createElement(n.li,null,"(ไม่จำเป็น) แนะนำให้ติดตั้ง Microsoft.Toolkit.Mvvm 7.1.2+ Microsoft.Extensions.DependencyInjection 6.0+ CommunityToolkit.WinUI.UI.Controls 7.1.2+ ด้วย"),"\n"),"\n",a.createElement(n.h2,{id:"ดาวน์โหลด-driver-สำหรับ-browser-ที่ต้องการใช้งาน"},"ดาวน์โหลด Driver สำหรับ Browser ที่ต้องการใช้งาน"),"\n",a.createElement(n.p,null,"อย่างกรณีของ Microsoft Edge ให้โหลดจาก ",a.createElement(n.a,{href:"https://developer.microsoft.com/en-us/microsoft-edge/tools/webdriver/"},"Edge Web Driver")," จากนั้นนำไฟล์ msedgedriver.exe ที่ได้ใส่ไว้ใน Project Folder แล้วตั้ง Property ชื่อ ",a.createElement(n.strong,null,"Copy to output directory")," (คลิกขวาที่ไฟล์แล้วเลือก Propeties) เป็น Copy if newer"),"\n",a.createElement(n.h2,{id:"browserautomationservice"},"BrowserAutomationService"),"\n",a.createElement(n.h3,{id:"interface-ibrowserautomationservice"},"Interface IBrowserAutomationService"),"\n",a.createElement(n.p,null,"เบื้องต้น BrowserAutomationService น่าจะมี Public methods ประมาณนี้"),"\n",a.createElement(n.pre,null,a.createElement(n.code,{className:"language-csharp"},"public interface IBrowserAutomationService\n{\n    Task<bool> AddEntry(Entry entry, CancellationToken cancellationToken);\n    Task Login(string username, string password, CancellationToken cancellationToken);\n    void StartBrowser();\n    void StopBrowser();\n}\n")),"\n",a.createElement(n.h3,{id:"เริ่มต้นและหยุด-browser"},"เริ่มต้นและหยุด Browser"),"\n",a.createElement(n.p,null,"เราจะเพิ่ม Method ที่ใช้ในการเริ่มและหยุด Browser ก่อน ตามด้านล่างนี้ โดย ",a.createElement(n.code,null,"delay")," field นั้นมีไว้เพื่อ ",a.createElement(n.strong,null,"Delay การควบคุมของ Selenium เพื่อให้ Browser มีเวลาแสดงผลหน้าเว็บก่อน"),"\nเพราะถ้าไม่รอให้ HTMLElement โหลดเสร็จก่อน การ query HTMLElement นั้น ก็จะไม่เจอ"),"\n",a.createElement(n.pre,null,a.createElement(n.code,{className:"language-csharp"},"using OpenQA.Selenium.Edge;\nusing OpenQA.Selenium;\nusing System.Threading.Tasks;\nusing System.Threading;\nusing OpenQA.Selenium.Support.UI;\nusing System;\n\npublic class BrowserAutomationService : IBrowserAutomationService\n{\n    private const int delay = 1000 * 1;\n    private EdgeDriver edgeDriver;\n    public void StartBrowser()\n    {\n        if (edgeDriver is null)\n        {\n            edgeDriver = new edgeDriver(new EdgeOptions());\n        }\n    }\n    public void StopBrowser()\n    {\n        edgeDriver.Quit();\n        edgeDriver = null;\n    }\n}\n")),"\n",a.createElement(n.h3,{id:"หน้า-login"},"หน้า Login"),"\n",a.createElement(i.l,{name:"login-page.jpg"}),"\n",a.createElement(n.p,null,"ลองดู HTML ของ Login ส่วนที่เป็นการกรอกฟอร์ม Login"),"\n",a.createElement(n.pre,null,a.createElement(n.code,{className:"language-html"},'<form class="" data-bitwarden-watching="1">\n  <div class="form-group">\n    <div class="float-label float-label-lg">\n      <input\n        id="username"\n        name="username"\n        placeholder="username"\n        type="text"\n        class="form-control form-control-lg"\n        aria-invalid="false"\n        value=""\n        spellcheck="false"\n        data-ms-editor="true"\n      />\n      <label for="username" class="">ชื่อผู้ใช้</label>\n    </div>\n  </div>\n  <div class="form-group">\n    <div class="float-label float-label-lg">\n      <input\n        id="password"\n        name="password"\n        placeholder="password"\n        type="password"\n        class="form-control form-control-lg"\n        aria-invalid="false"\n        value=""\n      />\n      <label for="password" class="">รหัสผ่าน</label>\n    </div>\n  </div>\n  <div class="text-right">\n    <button type="submit" class="btn btn-label-primary btn-lg btn-widest">\n      เข้าสู่ระบบ\n    </button>\n  </div>\n</form>\n')),"\n",a.createElement(n.p,null,"จะเห็นว่า Username และ Password นั้นกรอกไป ",a.createElement(n.code,null,'<input name="username">')," และ ",a.createElement(n.code,null,'<input name="password">')," ตามลำดับ\nและอยู่ภายใต้ Form Element อีกที ซึ่งแปลว่าเวลาเรา Trigger การ Submit (ไม่ว่ากด Enter เวลากำลังโฟกัส Input หรือกดปุ่ม)\nก็สามารถ Submit ได้ ดังนั้นสิ่งที่จะต้องทำคือ"),"\n",a.createElement(n.ol,null,"\n",a.createElement(n.li,null,"สั่งให้เปิดหน้า https://mohpromtstation.moph.go.th/login"),"\n",a.createElement(n.li,null,"รอเพจโหลดเสร็จ"),"\n",a.createElement(n.li,null,"หา ",a.createElement(n.code,null,'<input name="username">')," และ ",a.createElement(n.code,null,'<input name="password">')," แล้วกรอก username และ password"),"\n",a.createElement(n.li,null,"Submit ฟอร์ม"),"\n",a.createElement(n.li,null,"แล้วรอการ Submit"),"\n",a.createElement(n.li,null,"เปลี่ยนหน้าไปยัง https://mohpromtstation.moph.go.th/atk/record"),"\n"),"\n",a.createElement(n.p,null,"มันจะมีประเด็นตรงที่การรอ ที่เราจำเป็นต้องเขียน Code เพิ่มให้โปรแกรมรอจนกว่า Element นั้นจะปรากฎและสามารถ Query ได้ ซึ่งเราจะเขียน Extensions Method เพิ่มดังนี้"),"\n",a.createElement(n.pre,null,a.createElement(n.code,{className:"language-csharp"},"public static class WebDriverExtension\n{\n    public static IWebElement WaitForElement(this IWebDriver driver, By by, CancellationToken cancellationToken = default)\n    {\n      var wait = new WebDriverWait(driver, new TimeSpan(0, 0, 30));\n      return wait.Until(driver =>\n      {\n          try\n          {\n              var result = driver.FindElement(by);\n              return result.Displayed ? result : null;\n          }\n          catch (NoSuchElementException)\n          {\n              return null;\n          }\n          catch (ElementNotVisibleException)\n          {\n              return null;\n          }\n      }, cancellationToken);\n    }\n}\n")),"\n",a.createElement(n.p,null,a.createElement(n.code,null,"WaitForElement")," เป็น Extension method ของ ",a.createElement(n.code,null,"IWebDriver")," โดยการทำงานมันจะสร้าง ",a.createElement(n.code,null,"WebDriverWait")," object เพื่อรอเป็นเวลาไม่เกิน 30 วินาที และไม่สนใจ ",a.createElement(n.code,null,"NoSuchElementException"),"\n",a.createElement(n.code,null,"ElementNotVisibleException")," exceptions จากนั้นก็จะทำการรอจนว่า Element ซึ่งเราระบุผ่าน ",a.createElement(n.code,null,"by")," argument จะปรากฎขึ้นมา โดยรอไม่เกิน Timespan ที่กำหนด"),"\n",a.createElement(n.p,null,"จากนั้น เราจึงเริ่มสร้าง ",a.createElement(n.code,null,"Login")," method ได้ตามด้านล่าง"),"\n",a.createElement(n.pre,null,a.createElement(n.code,{className:"language-csharp"},'public class BrowserAutomationService : IBrowserAutomationService\n{\n  public async Task Login(string username, string password, CancellationToken cancellationToken)\n  {\n    cancellationToken.ThrowIfCancellationRequested();\n    edgeDriver.Navigate().GoToUrl("https://mohpromtstation.moph.go.th/login");\n\n    edgeDriver.WaitForElement(By.Name("username"), cancellationToken).SendKeys(username);\n    var passwordBox = edgeDriver.FindElement(By.Name("password"));\n    passwordBox.SendKeys(password);\n\n    cancellationToken.ThrowIfCancellationRequested();\n    passwordBox.Submit();\n    await Task.Delay(delay);\n\n    cancellationToken.ThrowIfCancellationRequested();\n    edgeDriver.Navigate().GoToUrl("https://mohpromtstation.moph.go.th/atk/record");\n  }\n}\n')),"\n",a.createElement(n.p,null,"เรามาดูขึ้นตอนการทำงานบางส่วนกัน"),"\n",a.createElement(n.ul,null,"\n",a.createElement(n.li,null,a.createElement(n.code,null,"cancellationToken.ThrowIfCancellationRequested();")," ที่เห็นซ้ำอยู่หลายครั้ง นั้นมีไว้เพื่อให้สามารถ Cancel Method ที่กำลังรันอยู่ได้ (เราจะเรียกใช้ Method นี้จาก Non-UI Thread)"),"\n",a.createElement(n.li,null,a.createElement(n.code,null,'edgeDriver.Navigate().GoToUrl("https://mohpromtstation.moph.go.th/login");')," นั้นจะสั่งให้ Browser เปลี่ยนหน้าไปยัง https://mohpromtstation.moph.go.th/login"),"\n",a.createElement(n.li,null,a.createElement(n.code,null,"await Task.Delay(delay);")," มีไว้เพื่อรอให้ Browser มีเวลาได้แสดงผลก่อนที่จะทำคำสั่งต่อไป"),"\n",a.createElement(n.li,null,a.createElement(n.code,null,'edgeDriver.WaitForElement(By.Name("username"), cancellationToken);')," ",a.createElement(n.strong,null,"ตัวเด็ด")," อันนี้เอาไว้สำหรับหา HTMLElement ที่มี ",a.createElement(n.code,null,"name"),' attribute เท่ากับ "username" โดยจะ return ผลลัพธ์แรกหรือ throw ',a.createElement(n.code,null,"NoSuchElementException")," หากไม่มี"),"\n",a.createElement(n.li,null,a.createElement(n.code,null,"passwordBox.SendKeys(password)")," Simulate การกรอก string ด้วย Keyboard"),"\n",a.createElement(n.li,null,a.createElement(n.code,null,"passwordBox.Submit();")," Submit ฟอร์ม (เหมือนการกดปุ่ม Enter เวลาโฟกัสที่ ",a.createElement(n.code,null,"<input>"),")"),"\n"),"\n",a.createElement(n.h3,{id:"หน้าบันทึกข้อมูล"},"หน้าบันทึกข้อมูล"),"\n",a.createElement(i.l,{name:"list-page.jpg"}),"\n",a.createElement(n.pre,null,a.createElement(n.code,{className:"language-html"},'<div class="portlet-addon">\n  <button class="btn btn-primary ml-2">เพิ่ม</button>\n  <button class="btn btn-success ml-2">เพิ่ม (ชาวต่างชาติ)</button>\n</div>\n')),"\n",a.createElement(n.p,null,"ดังนั้นเราจะใช้ XPath ",a.createElement(n.code,null,"\"//button[contains(text(), 'เพิ่ม')]\"")," ในการค้นหาแทน"),"\n",a.createElement(n.pre,null,a.createElement(n.code,{className:"language-csharp"},"edgeDriver.WaitForElement(By.XPath(\"//button[contains(text(), 'เพิ่ม')]\"), cancellationToken).Click();\n")),"\n",a.createElement(n.p,null,"พอเรากดปุ่มเพิ่มแล้วก็จะมาสู่หน้านี้"),"\n",a.createElement(i.l,{name:"pid-page.jpg"}),"\n",a.createElement(n.p,null,"ลองดู HTML ส่วนค้นหาชื่อก่อน"),"\n",a.createElement(n.pre,null,a.createElement(n.code,{className:"language-html"},'<form class="">\n  <div class="mt-2 form-group">\n    <div class="row">\n      <div class="col-10">\n        <div class="float-label float-label-lg">\n          <input\n            id="pid"\n            name="pid"\n            placeholder="1xxxxxxxxxxxx"\n            autocomplete="off"\n            pattern="^-?[0-9]"\n            type="number"\n            class="form-control"\n            value=""\n          />\n          <label for="pid" class="">เลขประจำตัวประชาชนผู้รับการตรวจ</label>\n        </div>\n      </div>\n      <div class="col-2">\n        <button type="submit" class="btn btn-info">ค้นหา</button>\n      </div>\n    </div>\n  </div>\n</form>\n')),"\n",a.createElement(n.p,null,"ตรงนี้ใช้หลักการเดียวกันด้านบน เหมือนหน้า Login เพียงแต่ตอนนี้เราจะเปลี่ยนมาใช้ CSS Selector แทน โดยการ Select ",a.createElement(n.code,null,'<input id="pid" />'),"\nเราจะใช้ ",a.createElement(n.code,null,'"#pid"')," ตามด้านล่าง"),"\n",a.createElement(n.pre,null,a.createElement(n.code,{className:"language-csharp"},'var cidBox = edgeDriver.WaitForElement(By.CssSelector("#pid"), cancellationToken);\ncidBox.SendKeys(entry.CitizenId.ToString());\n\ncancellationToken.ThrowIfCancellationRequested();\ncidBox.Submit();\n')),"\n",a.createElement(n.p,null,"พอกดค้นหาแล้ว ก็จะมาที่หน้านี้"),"\n",a.createElement(i.l,{name:"input-page.jpg"}),"\n",a.createElement(n.p,null,"ลองดู HTML ส่วนที่เราสนใจ คือ ช่อง ชื่อ สาเหตุ และ ผลการตรวจ"),"\n",a.createElement(n.pre,null,a.createElement(n.code,{className:"language-html"},'<form id="atkForm" class="">\n  <div class="form-group">\n    <div class="d-flex">\n      <label for="" class="">ชื่อผลิตภัณฑ์</label>\n      <div class="ml-3">\n        <div class="form-check form-check-inline">\n          <input\n            name="testType"\n            id="testType0"\n            type="radio"\n            class="form-check-input"\n            value="0"\n            checked=""\n          /><label for="testType0" class="form-check-label">Home Use</label>\n        </div>\n        <div class="form-check form-check-inline">\n          <input\n            name="testType"\n            id="testType1"\n            type="radio"\n            class="form-check-input"\n            value="1"\n          /><label for="testType1" class="form-check-label"\n            >Professional Use</label\n          >\n        </div>\n      </div>\n    </div>\n    <div class=" css-2b097c-container">\n      <span\n        aria-live="polite"\n        aria-atomic="false"\n        aria-relevant="additions text"\n        class="css-7pg0cj-a11yText"\n      ></span>\n      <div class=" css-19htjap-control">\n        <div class=" css-1gc0yoq">\n          <div class=" css-1uccc91-singleValue">\n            STANDARD Q COVID-19 Ag Home Test [T 6400120] [SD Biosensor Inc.,\n            Korea.]\n          </div>\n          <div class="css-1fe4407">\n            <div class="" style="display: inline-block;">\n              <input\n                autocapitalize="none"\n                autocomplete="off"\n                autocorrect="off"\n                id="react-select-atktest-input"\n                spellcheck="false"\n                tabindex="0"\n                type="text"\n                aria-autocomplete="list"\n                value=""\n                style="box-sizing: content-box; width: 2px; background: 0px center; border: 0px; font-size: inherit; opacity: 0; outline: 0px; padding: 0px; color: inherit;"\n              />\n              <div\n                style="position: absolute; top: 0px; left: 0px; visibility: hidden; height: 0px; overflow: scroll; white-space: pre; font-size: 12px; font-family: Poppins, sans-serif; font-weight: 400; font-style: normal; letter-spacing: normal; text-transform: none;"\n              ></div>\n            </div>\n          </div>\n        </div>\n        <div class=" css-1p1cok9">\n          <span class=" css-1hyfx7x"></span>\n          <div class=" css-tlfecz-indicatorContainer" aria-hidden="true">\n            <svg\n              height="20"\n              width="20"\n              viewBox="0 0 20 20"\n              aria-hidden="true"\n              focusable="false"\n              class="css-8mmkcg"\n            >\n              <path\n                d="M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747 3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0 1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502 0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0 0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"\n              ></path>\n            </svg>\n          </div>\n        </div>\n      </div>\n      <input name="atktest" type="hidden" value="1" />\n    </div>\n  </div>\n  <div class="form-group">\n    <label for="atkcs" class="">สาเหตุการตรวจ</label>\n    <div class=" css-2b097c-container">\n      <span\n        aria-live="polite"\n        aria-atomic="false"\n        aria-relevant="additions text"\n        class="css-7pg0cj-a11yText"\n      ></span>\n      <div class=" css-19htjap-control">\n        <div class=" css-1gc0yoq">\n          <div class=" css-1uccc91-singleValue">\n            Active case finding / Contract tracing (ค้นหาผู้สัมผัสในครอบครัว/\n            ที่ทำงาน/ ชุมชน)\n          </div>\n          <div class="css-1fe4407">\n            <div class="" style="display: inline-block;">\n              <input\n                autocapitalize="none"\n                autocomplete="off"\n                autocorrect="off"\n                id="react-select-atkcs-input"\n                spellcheck="false"\n                tabindex="0"\n                type="text"\n                aria-autocomplete="list"\n                value=""\n                style="box-sizing: content-box; width: 2px; background: 0px center; border: 0px; font-size: inherit; opacity: 0; outline: 0px; padding: 0px; color: inherit;"\n              />\n              <div\n                style="position: absolute; top: 0px; left: 0px; visibility: hidden; height: 0px; overflow: scroll; white-space: pre; font-size: 12px; font-family: Poppins, sans-serif; font-weight: 400; font-style: normal; letter-spacing: normal; text-transform: none;"\n              ></div>\n            </div>\n          </div>\n        </div>\n        <div class=" css-1p1cok9">\n          <span class=" css-1hyfx7x"></span>\n          <div class=" css-tlfecz-indicatorContainer" aria-hidden="true">\n            <svg\n              height="20"\n              width="20"\n              viewBox="0 0 20 20"\n              aria-hidden="true"\n              focusable="false"\n              class="css-8mmkcg"\n            >\n              <path\n                d="M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747 3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0 1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502 0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0 0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"\n              ></path>\n            </svg>\n          </div>\n        </div>\n      </div>\n      <input name="atkcs" type="hidden" value="5" />\n    </div>\n  </div>\n  <div class="form-group">\n    <label for="atkrs" class="">ผลการตรวจ</label>\n    <div class=" css-2b097c-container">\n      <span\n        aria-live="polite"\n        aria-atomic="false"\n        aria-relevant="additions text"\n        class="css-7pg0cj-a11yText"\n      ></span>\n      <div class=" css-19htjap-control">\n        <div class=" css-1gc0yoq">\n          <div class=" css-1uccc91-singleValue">ไม่พบ</div>\n          <div class="css-1fe4407">\n            <div class="" style="display: inline-block;">\n              <input\n                autocapitalize="none"\n                autocomplete="off"\n                autocorrect="off"\n                id="react-select-atkrs-input"\n                spellcheck="false"\n                tabindex="0"\n                type="text"\n                aria-autocomplete="list"\n                value=""\n                style="box-sizing: content-box; width: 2px; background: 0px center; border: 0px; font-size: inherit; opacity: 1; outline: 0px; padding: 0px; color: inherit;"\n              />\n              <div\n                style="position: absolute; top: 0px; left: 0px; visibility: hidden; height: 0px; overflow: scroll; white-space: pre; font-size: 12px; font-family: Poppins, sans-serif; font-weight: 400; font-style: normal; letter-spacing: normal; text-transform: none;"\n              ></div>\n            </div>\n          </div>\n        </div>\n        <div class=" css-1p1cok9">\n          <span class=" css-1hyfx7x"></span>\n          <div class=" css-tlfecz-indicatorContainer" aria-hidden="true">\n            <svg\n              height="20"\n              width="20"\n              viewBox="0 0 20 20"\n              aria-hidden="true"\n              focusable="false"\n              class="css-8mmkcg"\n            >\n              <path\n                d="M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747 3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0 1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502 0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0 0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"\n              ></path>\n            </svg>\n          </div>\n        </div>\n      </div>\n      <input name="atkrs" type="hidden" value="1" />\n    </div>\n  </div>\n</form>\n')),"\n",a.createElement(n.p,null,"ตรงนี้จะซับซ้อนเล็กน้อย ตือ จริงๆ แล้ว ข้อมูลที่มัน Submit ไปจริงๆ คือจาก ชื่อ ",a.createElement(n.code,null,'<input name="atktest" type="hidden" value="1">')," สาเหตุ ",a.createElement(n.code,null,'<input name="atkcs" type="hidden" value="5">')," และ ผลการตรวจ ",a.createElement(n.code,null,'<input name="atkrs" type="hidden" value="1">'),"\nส่วน input อื่นๆ ที่เห็นมีไว้เป็น Combo Box เท่านั้น (คือ HTML มี ",a.createElement(n.code,null,"<select />")," ก็จริงและก็พิมพ์เลือกได้ แต่มันจะไม่มีช่องให้ดูสวยงามแบบนี้) ดังนั้น เป้าหมายของเราในการ Automate จะเป็นด้านล่างนี้แทน ทั้งนี้คือเพื่อให้คนที่เฝ้าดูการ Automate เห็นการเลือกค่าที่ถูกต้องด้สน"),"\n",a.createElement(n.ul,null,"\n",a.createElement(n.li,null,a.createElement(n.code,null,'<input id="react-select-atktest-input" />')," เป็นช่องให้เราพิมพ์เลือกชื่อ ATK"),"\n",a.createElement(n.li,null,a.createElement(n.code,null,'<input id="react-select-atkcs-input" />')," เป็นช่องให้เราพิมพ์เลือกสาเหตุตรวจ"),"\n",a.createElement(n.li,null,a.createElement(n.code,null,'<input id="react-select-atkrs-input" />')," เป็นช่องให้เราพิมพ์เลือกผลตรวจ"),"\n"),"\n",a.createElement(n.p,null,"ซึ่งเราจะใช้ Css Selector ในการเลือกและกรอกข้อมูล เช่นเดียวกัน ตาม ",a.createElement(n.code,null,"AddEntry")," method ที่สมบูรณ์ ตามด้านล่าง"),"\n",a.createElement(n.pre,null,a.createElement(n.code,{className:"language-csharp"},'public class BrowserAutomationService : IBrowserAutomationService\n{\n  public async Task<bool> AddEntry(Entry entry, CancellationToken cancellationToken)\n  {\n      if (entry.Done) return true;\n\n      bool done = false;\n\n      edgeDriver.WaitForElement(By.XPath("//button[contains(text(), \'เพิ่ม\')]"), cancellationToken).Click();\n\n      var cidBox = edgeDriver.WaitForElement(By.CssSelector("#pid"), cancellationToken);\n      cidBox.SendKeys(entry.CitizenId.ToString());\n\n      cancellationToken.ThrowIfCancellationRequested();\n      cidBox.Submit();\n\n      try\n      {\n          var atkTypeBox = edgeDriver.WaitForElement(By.CssSelector("#react-select-atktest-input"), cancellationToken);\n          atkTypeBox.SendKeys("GSD");\n          atkTypeBox.SendKeys(Keys.Tab);\n          var atkReasonBox = edgeDriver.FindElement(By.CssSelector("#react-select-atkcs-input"));\n          atkReasonBox.SendKeys("ให้ตรวจเพิ่มเติมตาม");\n          atkReasonBox.SendKeys(Keys.Tab);\n          var atkResultBox = edgeDriver.FindElement(By.CssSelector("#react-select-atkrs-input"));\n          switch (entry.Result)\n          {\n              case ATKResult.Detected:\n                  atkResultBox.SendKeys("พบ");\n                  atkResultBox.SendKeys(Keys.ArrowDown);\n                  atkResultBox.SendKeys(Keys.Tab);\n                  break;\n              case ATKResult.NotDetected:\n                  atkResultBox.SendKeys("ไม่พบ");\n                  atkResultBox.SendKeys(Keys.Tab);\n                  break;\n              case ATKResult.Indeterminate:\n                  break;\n          }\n\n          cancellationToken.ThrowIfCancellationRequested();\n          atkResultBox.Submit();\n\n          edgeDriver.WaitForElement(By.CssSelector(".swal2-confirm"), cancellationToken).Click(); // ปุ่ม ตกลง หลังแสดงว่าบันทึกสำเร็จ\n          await Task.Delay(delay);\n          edgeDriver.WaitForElement(By.XPath("//button[contains(text(), \'ปิด\')]"), cancellationToken).Click();\n          done = true;\n      }\n      catch (Exception ex)\n      {\n          edgeDriver.Navigate().GoToUrl("https://mohpromtstation.moph.go.th/atk/record");\n          await Task.Delay(delay);\n      }\n\n      return done;\n  }\n}\n')),"\n",a.createElement(n.h1,{id:"จบแล้ว-ตอนที่-1"},"จบแล้ว ตอนที่ 1"),"\n",a.createElement(n.p,null,"จริงๆ Code นี้ เรียกว่าเพียงพอในการ Automate แล้ว แต่มันยังไม่เป็น Application จริงๆ ตอนต่อไป เราจะมาดูการสร้าง Application ด้วย Windows App SDK"))}var s=function(e){void 0===e&&(e={});const{wrapper:n}=Object.assign({},(0,l.R)(),e.components);return n?a.createElement(n,e,a.createElement(r,e)):r(e)},o=t(7387),c=t(1010),d=t(2532),m=t(1714),u=t(8322),p=t(2333),v=t(9518),g=t(8106);let h=function(e){function n(n){var t;return(t=e.call(this,n)||this).useTOC=!1,"undefined"!=typeof window&&(t.target=decodeURIComponent(window.location.hash),t.target=t.target.replace("#",""),window.location.hash=""),t}(0,o.A)(n,e);var t=n.prototype;return t.renderAuthors=function(e){const n=e.map((e,n)=>{const t=e.position.map((e,n)=>a.createElement("div",{key:n},e));return a.createElement("div",{className:"author",key:n},a.createElement("div",{className:"image-container"},a.createElement(d.G,{image:e.avatar.childImageSharp.gatsbyImageData,style:{borderRadius:"50%"},alt:e.name})),a.createElement("div",{className:"title-container"},e.name),a.createElement("div",{className:"positions-container"},t))});return a.createElement("div",{className:"author-container"},n)},t.renderTOCItem=function(e,n){void 0===n&&(n=0);const t=e.map((e,t)=>null!=e.items&&e.items.length>0?a.createElement(v.P,{key:n+t,title:e.title,url:e.url},this.renderTOCItem(e.items,100*t)):a.createElement("li",{key:n+t},a.createElement("a",{href:e.url,onClick:u.Ay},e.title)));return a.createElement("ul",null,t)},t.renderTOC=function(e){return e.length>0?a.createElement("div",{id:"toc",className:"toc-container"},this.renderTOCItem(e)):""},t.componentDidMount=function(){""!==this.target?(0,u.O8)(this.target):this.target=""},t.render=function(){const{data:{mdx:{tableOfContents:{items:e},frontmatter:{title:n,type:t,background:i,images:r,date:s,authors:o,excerpt:u}}},children:h}=this.props,E=o,f=e;let b=a.createElement("div",null);return null==E&&null==f||(b=a.createElement(a.Fragment,null,null!=E?this.renderAuthors(E):"",null!=f?this.renderTOC(f):"")),a.createElement(p.T,{title:n,tagLine:s,GatsyImageElement:a.createElement(d.G,{image:(0,d.c)(i),alt:n}),aside:b},null!=u?a.createElement(c.k,{title:n,description:u,imageUrl:i.publicURL,imageWidth:i.childImageSharp.original.width,imageHeight:i.childImageSharp.original.height}):a.createElement(c.k,{title:n,description:u}),a.createElement("div",{className:"MDXRenderer-body"},a.createElement(l.x,{components:{h1:e=>a.createElement(v.H1,Object.assign({useToc:this.useTOC},e)),h2:e=>a.createElement(v.H2,Object.assign({useToc:this.useTOC},e)),h3:e=>a.createElement(v.H3,Object.assign({useToc:this.useTOC},e)),h4:e=>a.createElement(v.H4,Object.assign({useToc:this.useTOC},e)),pre:m.A,GatsbyImage:d.G}},a.createElement(g.B.Provider,{value:{imagesList:r}},h))))},n}(a.Component);function E(e){return a.createElement(h,e,a.createElement(s,e))}},7e3:function(e,n,t){t.d(n,{l:function(){return r}});var l=t(6540),a=t(2532),i=t(8106);const r=e=>{var n,t;let{imageList:r,mode:s="block",className:o="",name:c,alt:d="",caption:m,...u}=e;r=null!==(n=r)&&void 0!==n?n:l.useContext(i.B).imagesList;const p=null===(t=r)||void 0===t?void 0:t.find(e=>(null==e?void 0:e.name)===c.substring(0,c.lastIndexOf(".")));return null!=p&&void 0!==p?l.createElement("div",{className:"image-container"},l.createElement("div",{className:`${o} ${s}`},l.createElement(a.G,Object.assign({image:p.childImageSharp.gatsbyImageData},u,{alt:d})),m&&l.createElement("div",{className:"text-center"},m))):l.createElement("div",{className:"p-6 font-bold"},c," is not exist")}}}]);